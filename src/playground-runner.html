<!DOCTYPE html>
<html style="height: 100%;">
  <head>
    <link data-inline="yes-please" href="./spinner.css" rel="stylesheet" />

    <link
      data-name="vs/editor/editor.main"
      rel="stylesheet"
      href="../node_modules/monaco-editor/dev/vs/editor/editor.main.css"
    />

    <style type="text/css">
      body {
        margin: 0;
        padding: 0;
        border: 0;
      }
    </style>
  </head>
  <body>
    <div id="loading">
      <div class="spinner">
        <div class="rect1"></div>
        <div class="rect2"></div>
        <div class="rect3"></div>
        <div class="rect4"></div>
        <div class="rect5"></div>
      </div>
    </div>

    <script>
      var require = { paths: { vs: "../node_modules/monaco-editor/dev/vs" } };
    </script>
    <script src="../node_modules/monaco-editor/dev/vs/loader.js"></script>
    <script src="../node_modules/monaco-editor/dev/vs/editor/editor.main.nls.js"></script>
    <script src="../node_modules/monaco-editor/dev/vs/editor/editor.main.js"></script>

    <script type="text/javascript">
      var receivedCall = null;
      window.load = function (js, html, css) {
        receivedCall = {
          json: json,
          html: html,
        };
      };
    </script>

    <script type="text/javascript">
      require(["require", "vs/editor/editor.main"], function (require) {
        "use strict";

        var loading = document.getElementById("loading");
        loading.parentNode.removeChild(loading);
        document.body.style.height = "100%";

        window.load = function (json, html) {
          const Liquid = window.liquidjs.Liquid;
          const engine = new Liquid();
          const tpl = engine.parse(html);
          engine.render(tpl, json).then(function (value) {
            monaco.editor.create(document.getElementById("container"), {
              value: value,
              language: "html",
            });
          }, console.error);
        };

        if (receivedCall) {
          window.load(receivedCall.json, receivedCall.html);
        }
      });
    </script>
    <div id="container" style="height: 100%;"></div>
  </body>
</html>
